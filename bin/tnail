#! /usr/bin/perl

use warnings;
use strict;
use URI::Escape;

# tnail
# take a list of files and output html

while (<>) {
    chomp;
    my $file = $_;
    $file =~ s/public//;

    my $link = $file;
    $link =~ s/-\d{3,4}x\d{3,4}//;

    my $title = $link;
    $title =~ s/^.*\///;
    $title =~ s/\.jpg//;
    $title =~ s/\d{4}-\d{2}-\d{2}-//;
    $title =~ s/[-_]/ /g;
    $title =~ s/([\w']+)/\u\L$1/g;

    my $ttl = uri_escape($title);

    my $html = <<"HTML";
<figure class="thumbnail">
    <a href="/viewimage?image=$link&title=$ttl" title="$title"><img src="$file" alt="$title"></a>
    <figcaption>$title</figcaption>
</figure>

HTML

    print $html;

}



